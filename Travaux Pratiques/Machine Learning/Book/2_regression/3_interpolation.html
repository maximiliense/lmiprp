
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Interpolation â˜•ï¸â˜•ï¸ &#8212; Machine Learning</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"processClass": "tex2jax_process|mathjax_process|math|output_area"}})</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sous-diffÃ©rentiel et le cas du Lasso â˜•ï¸â˜•ï¸â˜•ï¸" href="4_algo_proximal_lasso.html" />
    <link rel="prev" title="Lâ€™optimisation â˜•ï¸â˜•ï¸" href="2_optimization.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-72WWYCKNK6"></script>
<script>
                    window.dataLayer = window.dataLayer || [];
                    function gtag(){ dataLayer.push(arguments); }
                    gtag('js', new Date());
                    gtag('config', 'G-72WWYCKNK6');
                </script>

  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Machine Learning</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Introduction
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../0_requisite/rappels_python.html">
   Rappels de Python et Numpy
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../1_what_is_ml/0_propos_liminaire.html">
   <em>
    Machine Learning
   </em>
   , initiation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_what_is_ml/1_introduction_ml.html">
     <em>
      Machine learning
     </em>
     et malÃ©diction de la dimension
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../1_what_is_ml/2_regression_and_classification_trees.html">
     Les arbres de rÃ©gression et de classification
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="0_propos_liminaire.html">
   La
   <em>
    rÃ©gression
   </em>
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="1_linear_regression.html">
     La rÃ©gression linÃ©aire â˜•ï¸
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="2_optimization.html">
     Lâ€™optimisation â˜•ï¸â˜•ï¸
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Interpolation â˜•ï¸â˜•ï¸
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="4_algo_proximal_lasso.html">
     Sous-diffÃ©rentiel et le cas du Lasso â˜•ï¸â˜•ï¸â˜•ï¸
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="5_least_square_qr.html">
     Les moindres carrÃ©s via une dÃ©composition QR (et plus)â˜•ï¸
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="6_ridge.html">
     Une analyse de la rÃ©gularisation Ridge â˜•ï¸â˜•ï¸â˜•ï¸
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../3_classification/0_propos_liminaire.html">
   La
   <em>
    classification
   </em>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_classification/1_logistic_regression.html">
     La rÃ©gression logistique â˜•ï¸
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_classification/2_fonctions_proxy.html">
     Les fonctions de perte (loss function) â˜•ï¸â˜•ï¸â˜•ï¸
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_classification/3_bayes_classifier.html">
     Le classifieur de Bayes â˜•ï¸
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../3_classification/4_VC_theory.html">
     Un modÃ¨le formel de lâ€™apprentissage â˜•ï¸â˜•ï¸â˜•ï¸â˜•ï¸ (ğŸ’†â€â™‚ï¸)
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../4_kernel_methods/0_propos_liminaire.html">
   Les mÃ©thodes Ã  noyaux
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../4_kernel_methods/1_svm.html">
     Le SVM ou lâ€™hypothÃ¨se max-margin â˜•ï¸â˜•ï¸
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../5_ensembles/0_propos_liminaire.html">
   Les mÃ©thodes
   <em>
    ensemblistes
   </em>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_ensembles/1_ensembles.html">
     MÃ©thodes ensemblistes â˜•ï¸â˜•ï¸
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../5_ensembles/2_bayesian_linear_regression.html">
     Bayesian linear regression â˜•ï¸â˜•ï¸â˜•ï¸â˜•ï¸
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../6_deeplearning/0_propos_liminaire.html">
   <em>
    deep learning
   </em>
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_deeplearning/1_autodiff.html">
     La diffÃ©rentiation automatique et un dÃ©but de
     <em>
      deep learning
     </em>
     â˜•ï¸
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_deeplearning/2_filters_representation.html">
     Filtres et espace de reprÃ©sentation des rÃ©seaux de neurones â˜•ï¸â˜•ï¸
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_deeplearning/3_probabilities_calibration.html">
     Calibration des probabilitÃ©s et quelques notions â˜•ï¸
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_deeplearning/4_regularization_deep.html">
     RÃ©gularisation en
     <em>
      deep learning
     </em>
     â˜•ï¸â˜•ï¸
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_deeplearning/5_transfer_multitask.html">
     <em>
      Transfer learning
     </em>
     et apprentissage multi-tÃ¢ches â˜•ï¸â˜•ï¸
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../6_deeplearning/6_adversarial.html">
     Les attaques adversaires â˜•ï¸
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../7_unsupervised/0_propos_liminaire.html">
   Lâ€™apprentissage non-supervisÃ©
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_unsupervised/1_principal_component_analysis.html">
     Lâ€™Analyse en Composantes Principales â˜•ï¸â˜•ï¸â˜•ï¸
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../7_unsupervised/2_em_gaussin_mixture_model.html">
     ModÃ¨le de MÃ©lange Gaussien et algorithme
     <em>
      Expectation-Maximization
     </em>
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../8_set_prediction/0_propos_liminaire.html">
   PrÃ©diction dâ€™ensembles
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../8_set_prediction/1_well_defined.html">
     Jeu dâ€™apprentissage
     <em>
      set-valued
     </em>
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../8_set_prediction/2_ill_defined.html">
     Jeu dâ€™apprentissage uniquement multi-classes â˜•ï¸
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../biblio.html">
   Bibliographie
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/2_regression/3_interpolation.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/maximiliense/lmiprp"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/maximiliense/lmiprp/issues/new?title=Issue%20on%20page%20%2F2_regression/3_interpolation.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        
        
        <a class="colab-button" href="https://colab.research.google.com/github/maximiliense/lmiprp/blob/master/Travaux Pratiques/Machine Learning/Book/2_regression/3_interpolation.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#i-introduction">
   I. Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#ii-quelques-exemples-simples-d-interpolations">
   II. Quelques exemples simples dâ€™interpolations
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-interpolation-constante-par-morceau-interpolateur-d-ordre-0">
     A. Interpolation constante par morceau (interpolateur dâ€™ordre
     <span class="math notranslate nohighlight">
      \(0\)
     </span>
     )
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-interpolation-lineaire-interpolateur-d-ordre-1">
     B. Interpolation linÃ©aire (interpolateur dâ€™ordre
     <span class="math notranslate nohighlight">
      \(1\)
     </span>
     )
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#iii-interpolation-polynomiale">
   III. Interpolation polynomiale
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-polynome-interpolateur-de-lagrange">
     A. Polynome interpolateur de Lagrange
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-interpolation-polynomiale-par-regression-non-lineaire">
     B. Interpolation polynomiale par rÃ©gression (non) linÃ©aire
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#iv-splines">
   IV. Splines
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-les-splines-cubiques">
     A. Les splines cubiques
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-estimation-des-coefficients">
     B. Estimation des coefficients
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#v-de-l-interpollation-vers-l-approximation">
   V. De lâ€™interpollation vers lâ€™approximation
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="interpolation">
<h1>Interpolation â˜•ï¸â˜•ï¸<a class="headerlink" href="#interpolation" title="Permalink to this headline">Â¶</a></h1>
<div class="admonition-objectifs-de-la-sequence admonition">
<p class="admonition-title">Objectifs de la sÃ©quence</p>
<ul class="simple">
<li><p>ÃŠtre sensibilisÃ©</p>
<ul>
<li><p>Ã€ la notion dâ€™interpolation,</p></li>
<li><p>Au fait quâ€™on fait des maths <strong>sur</strong> un ordinateur avec son lot dâ€™approximations numÃ©riques.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="i-introduction">
<h2>I. Introduction<a class="headerlink" href="#i-introduction" title="Permalink to this headline">Â¶</a></h2>
<p>Ce TP est une ouverture et nâ€™est pas du <em>machine learning</em> Ã  proprement parler. Nous allons cependant mettre en avant un ensemble de phÃ©nomÃ¨nes trÃ¨s pertinents en <em>machine learning</em>. Soit un espace de dÃ©part, notÃ© <span class="math notranslate nohighlight">\(\mathcal{X}\subseteq\mathbb{R}^d\)</span>, <span class="math notranslate nohighlight">\(d&gt;0\)</span> et un espace dâ€™arrivÃ©e <span class="math notranslate nohighlight">\(\mathcal{Y}\subseteq\mathbb{R}\)</span>. Supposons quâ€™il existe une fonction <span class="math notranslate nohighlight">\(f^\star:\mathcal{X}\rightarrow\mathcal{Y}\)</span> inconnue mais quâ€™il soit possible de collecter un jeu de donnÃ©es de la forme <span class="math notranslate nohighlight">\(S_n=\{(x_i, y_i=f^\star(x_i))\}_{i\leq n}\)</span>. Lâ€™objectif de lâ€™interpolation va Ãªtre de trouver une fonction <span class="math notranslate nohighlight">\(\hat{f}:\mathcal{X}\rightarrow\mathcal{Y}\)</span> telle que <span class="math notranslate nohighlight">\(\forall x_i, y_i\in S_n\)</span>, nous ayons <span class="math notranslate nohighlight">\(\hat{f}(x_i)=y_i=f^\star(x_i)\)</span>. De plus, on espÃ¨re quâ€™en faisant cela, la fonction <span class="math notranslate nohighlight">\(\hat{f}\)</span> ne soit pas trÃ¨s loin de la fonction <span class="math notranslate nohighlight">\(f^\star\)</span> sur les parties de son domaine entre les points de notre jeu de donnÃ©es.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">5001</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">x</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_interpolation_2_0.png" src="../_images/3_interpolation_2_0.png" />
</div>
</div>
<p>Construisons notre jeu de donnÃ©es en Ã©chantilonnant quelques points dans <span class="math notranslate nohighlight">\(\mathcal{X}\)</span>.</p>
<div class="cell tag_hide-input docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">X</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">S</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_interpolation_4_0.png" src="../_images/3_interpolation_4_0.png" />
</div>
</div>
<p>La courbe bleue est la courbe quâ€™on recherche. Les points bleus sont les seules informations visibles auxquelles nous avons accÃ¨s. Lâ€™objectif est de sâ€™appuyer sur ces informations pour construire les meilleures fonctions possibles. Cela peut se faire de beaucoup de maniÃ¨res diffÃ©rentes et nous allons en Ã©tudier quelques unes.</p>
</div>
<div class="section" id="ii-quelques-exemples-simples-d-interpolations">
<h2>II. Quelques exemples simples dâ€™interpolations<a class="headerlink" href="#ii-quelques-exemples-simples-d-interpolations" title="Permalink to this headline">Â¶</a></h2>
<div class="section" id="a-interpolation-constante-par-morceau-interpolateur-d-ordre-0">
<h3>A. Interpolation constante par morceau (interpolateur dâ€™ordre <span class="math notranslate nohighlight">\(0\)</span>)<a class="headerlink" href="#a-interpolation-constante-par-morceau-interpolateur-d-ordre-0" title="Permalink to this headline">Â¶</a></h3>
<p>Lâ€™idÃ©e est de considÃ©rer que la valeur de notre fonction est celle du point le plus proche : câ€™est le 1NN !</p>
<div class="admonition-exercice admonition">
<p class="admonition-title">Exercice</p>
<p>Proposez un code qui retourne pour chaque valeur du vecteur x, le label associÃ© au point le plus proche de notre jeu de donnÃ©es <span class="math notranslate nohighlight">\(S\)</span>.</p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_piece_wise_constant</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">])</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="c1">####### Complete this part ######## or die ####################    </span>
    <span class="o">...</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="o">...</span>
    <span class="c1">###############################################################</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">S</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_piece_wise_constant</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Ã‰tudions visuellement la convergence de cette mÃ©thode.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">]):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">X</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">S</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_piece_wise_constant</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Size:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>On voit que les endroits oÃ¹ lâ€™interpolation nous gÃªne correspondent aux angles de nos palliers. Nous pouvons faire mieux via une interpolation linÃ©aire.</p>
</div>
<div class="section" id="b-interpolation-lineaire-interpolateur-d-ordre-1">
<h3>B. Interpolation linÃ©aire (interpolateur dâ€™ordre <span class="math notranslate nohighlight">\(1\)</span>)<a class="headerlink" href="#b-interpolation-lineaire-interpolateur-d-ordre-1" title="Permalink to this headline">Â¶</a></h3>
<p>Au lieu de nâ€™exploiter que lâ€™information du point le plus proche, lâ€™idÃ©e est dâ€™ici dâ€™interpoler linÃ©airement entre les deux points qui encadrent notre valeur. Notons <span class="math notranslate nohighlight">\((x_l, y_l)\in S_n\)</span> le point qui encadre par la gauche notre nouveau <span class="math notranslate nohighlight">\(x\)</span> et <span class="math notranslate nohighlight">\((x_r, y_r)\in S_n\)</span> celui de droite. Une interpolation linÃ©aire se calcule tout simplement de la maniÃ¨re suivante :</p>
<div class="math notranslate nohighlight">
\[q(x)=y_r+(y_l-y_r)\frac{x-x_r}{x_l-x_r},\ x\in[x_l, x_r].\]</div>
<div class="admonition-exercice admonition">
<p class="admonition-title">Exercice</p>
<p><strong>Proposez un code qui retourne pour chaque valeur du vecteur x, son interpolation linÃ©aire sâ€™il est bien encadrÃ© et <span class="math notranslate nohighlight">\(\texttt{None}\)</span> sinon.</strong></p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_linear</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">])</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="c1">####### Complete this part ######## or die ####################</span>
    <span class="o">...</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="o">...</span>
    <span class="c1">###############################################################</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">]):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">X</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">S</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_linear</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Size:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="iii-interpolation-polynomiale">
<h2>III. Interpolation polynomiale<a class="headerlink" href="#iii-interpolation-polynomiale" title="Permalink to this headline">Â¶</a></h2>
<p>Lâ€™interpolation linÃ©aire donne de bon rÃ©sultats sauf quâ€™en pratique les fonctions quâ€™on cherche Ã  estimer sont plus â€œlissesâ€. Lâ€™idÃ©e va Ãªtre de contourner cela par une interpolation polynomiale.</p>
<div class="section" id="a-polynome-interpolateur-de-lagrange">
<h3>A. Polynome interpolateur de Lagrange<a class="headerlink" href="#a-polynome-interpolateur-de-lagrange" title="Permalink to this headline">Â¶</a></h3>
<p>On souhaite construire un polynome interpolateur dâ€™une fonction dont nous possÃ©dons des points de mesure <span class="math notranslate nohighlight">\(\mathcal{S} = \{(x_1, y_1), \dots (x_n, y_n)\}\)</span> et oÃ¹ on suppose les <span class="math notranslate nohighlight">\(x_i\)</span> deux Ã  deux distincts. Pour cela, nous allons construire une solution de ce typeÂ :</p>
<div class="math notranslate nohighlight">
\[L(x) = \sum_{j=1}^{N}y_jL_j(x)\]</div>
<p>Câ€™est-Ã -dire une combinaison de polynomes <span class="math notranslate nohighlight">\(L_j\)</span> dont on souhaitera quâ€™ils aient la propriÃ©tÃ© suivanteÂ :</p>
<div class="math notranslate nohighlight">
\[\begin{split}L_j(x) = \begin{cases} 
      1 &amp; x = x_j \\
      0 &amp; x \neq x_j, \exists l\leq n, x=x_l
\end{cases}\end{split}\]</div>
<p>Chaque polynome sâ€™annule exactement en tous les points dâ€™interpolation sauf un. La somme passe donc exactement par tous les points. On aura donc <span class="math notranslate nohighlight">\(L(x_i)=y_i\)</span> <span class="math notranslate nohighlight">\(\forall (x_i, y_i) \in \mathcal{S}\)</span>.</p>
<p><strong>PremiÃ¨re tentative naiveÂ :</strong></p>
<p>On peut dÃ©finir les <span class="math notranslate nohighlight">\(L_j\)</span>, polynÃ´mes intermÃ©diaires dont lâ€™expression est donnÃ©e parÂ :</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
    L_j(x) = \prod\limits_{\substack{k=1 \\ k\neq j}}^N x - x_k
\end{equation*}\]</div>
<p>on aurait donc <span class="math notranslate nohighlight">\(\forall i \neq j, L_j(x_i) = 0\)</span>. Nous avons bien <span class="math notranslate nohighlight">\(0\)</span> lorsque <span class="math notranslate nohighlight">\(i\neq j\)</span>, mais nous Ã©chouons Ã  obtenir <span class="math notranslate nohighlight">\(1\)</span> lors que <span class="math notranslate nohighlight">\(i=j\)</span>Â :</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
    L_j(x_j) = \prod\limits_{\substack{k=1 \\ k\neq j}}^N x_j  - x_k \neq 1
\end{equation*}\]</div>
<p>Nous pouvons rÃ©soudre cela en normalisant notre premiÃ¨re tentative par ce terme pour quâ€™on obtienne bien ce quâ€™on veutÂ :</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
    L_j(x) =  \frac{\prod\limits_{\substack{k=1 \\ k\neq j}}^Nx - x_k}{\prod\limits_{\substack{k=1 \\ k\neq j}}^Nx_j - x_k} = \prod\limits_{\substack{k=1 \\ k\neq j}}^N\frac{x - x_k}{x_j - x_k}
\end{equation*}\]</div>
<p>Nous obtenons doncÂ :</p>
<div class="amsmath math notranslate nohighlight">
\[\begin{equation*}
    L(x) = \sum_{j=1}^{N}y_j\prod\limits_{\substack{k=1 \\ k\neq j}}^N  \frac{x - x_k}{x_j - x_k}
\end{equation*}\]</div>
<div class="admonition-exercice admonition">
<p class="admonition-title">Exercice</p>
<p><strong>Montrez que le polynÃ´me rÃ©sultant est bien de degrÃ© <span class="math notranslate nohighlight">\(N-1\)</span>.</strong></p>
</div>
<div class="admonition-exercice-complementaire admonition">
<p class="admonition-title">Exercice complÃ©mentaire</p>
<p><strong>DÃ©montrez que le polynÃ´me est bien un polynÃ´me interpolateur et passe bien par lâ€™ensemble des points de notre jeu de donnÃ©es.</strong></p>
</div>
<div class="admonition-exercice admonition">
<p class="admonition-title">Exercice</p>
<p><strong>Proposez un code qui rÃ©alise lâ€™interpolation de Lagrange et retourne pour chacune des valeurs de <span class="math notranslate nohighlight">\(x\)</span> son interpolation.</strong></p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">f_polynomial</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="c1">####### Complete this part ######## or die ####################</span>
    <span class="o">...</span>
    <span class="o">...</span>
    <span class="k">return</span> <span class="o">...</span>
    <span class="c1">###############################################################</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">]):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">X</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">S</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_polynomial</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Size:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>On remarque que notre polynÃ´me en sâ€™Ã©cartant des points de notre jeu de donnÃ©es et notamment sur les bords, devient trÃ¨s instable. Et cela est dâ€™autant plus vrai que nous avons augmentÃ© le nombre de points (ce qui peut sembler contre-intuitif).</p>
</div>
<div class="section" id="b-interpolation-polynomiale-par-regression-non-lineaire">
<h3>B. Interpolation polynomiale par rÃ©gression (non) linÃ©aire<a class="headerlink" href="#b-interpolation-polynomiale-par-regression-non-lineaire" title="Permalink to this headline">Â¶</a></h3>
<p>Nous allons voir dans cette section quâ€™il est aussi possible de produire des fonctions interpolatrices Ã  partir du formalisme des moindres carrÃ©s que nous avons vu prÃ©cÃ©demment. En effet, comme nous lâ€™avons vu dans le TP sur la regression linÃ©aire, il est possible de reprÃ©senter nâ€™importe quel polynÃ´me de la faÃ§on suivanteÂ :</p>
<div class="math notranslate nohighlight">
\[L(x)  = \beta_0 + \sum_{i=1}^p \beta_i x^i = \langle \boldsymbol{\beta},  \phi_p(x) \rangle\]</div>
<p>avecÂ :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}\phi_p(x) =  \begin{bmatrix}
           1 \\
           x\\
           \vdots\\
           x^p
         \end{bmatrix}\end{aligned}\end{split}\]</div>
<p>AprÃ¨s avoir procÃ©dÃ© Ã  ce changement de variable sur les tous les Ã©chantillons, nous pouvons dÃ©finir la nouvelle matrice des donnÃ©es commeÂ :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}\boldsymbol{\Phi}_p(\boldsymbol{X}) = 
\begin{pmatrix} 
1 &amp; x_{1} &amp; x_{1}^2 &amp; \dots &amp; x_1^p \\
. &amp; . &amp; \dots &amp; .\\
1 &amp; x_{j}  &amp; x_{j}^2 &amp; \dots &amp; x_j^p\\
. &amp; . &amp; \dots &amp; .\\
1 &amp; x_{N}  &amp; x_{N}^2 &amp; \dots &amp; x_N^p
\end{pmatrix}\end{aligned}\end{split}\]</div>
<p>Et notre polynÃ´me se construit de la maniÃ¨re suivanteÂ :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}\boldsymbol{L(X)} = \Big[\boldsymbol{\Phi}_p(\boldsymbol{X}) \Big]
\boldsymbol{\beta}  = 
\begin{pmatrix} 
\beta_0 + \beta_1 x_{1} + \beta_2 x_{1}^2 + \dots + \beta_p x_1^p \\
\dots \\
\beta_0 + \beta_1 x_{j} + \beta_2 x_{j}^2 + \dots + \beta_p x_j^p\\
\dots\\
\beta_0 + \beta_1 x_{N}  + \beta_2 x_{N}^2 + \dots + \beta_p x_N^p
\end{pmatrix},\ \boldsymbol{\beta}\in\mathbb{R}^{p+1}\text{ et }\boldsymbol{L(X)}\in\mathbb{R}^N.
\end{aligned}\end{split}\]</div>
<p>Nous avons donc donc un systÃ¨me linÃ©aire de <span class="math notranslate nohighlight">\(p+1\)</span> Ã©quations et <span class="math notranslate nohighlight">\(N\)</span> inconnues. Il est ainsi possible dâ€™approximer une fonction non linÃ©aire qui minimise les erreurs au carrÃ© entre les valeurs du polynÃ´me Ã©valuÃ©s avec les vraies valeurs de notre jeu de donnÃ©es. Nous avons transformÃ© noter problÃ¨me de regression linÃ©aire en un probleme de regression polynÃ´miale (non linÃ©aire).</p>
<div class="admonition-question-1 admonition">
<p class="admonition-title">Question 1</p>
<p><strong>Rappellez lâ€™expression de la solution des equations normales des moindres carrÃ©s et adaptez-la Ã  ce changement de variable pour trouver les coefficients du polynÃ´me qui minimise les moindres carrÃ©s.</strong></p>
</div>
<div class="admonition-question-2 admonition">
<p class="admonition-title">Question 2</p>
<p><strong>Pour quelle(s) valeur(s) de <span class="math notranslate nohighlight">\(p\)</span> (ordre du polynÃ´me) nous avons une solution interpolatrice de maniÃ¨re garantie ? Rappellez lâ€™origine des difficultÃ©s sur la stabilitÃ© de la solution obtenues par la mÃ©thodes des EQN ?</strong></p>
</div>
<div class="warning admonition">
<p class="admonition-title">Remarque</p>
<p>Il est intÃ©ressant de montrer que la solution des EQN obtenue Ã  partir de la matrice  <span class="math notranslate nohighlight">\(\boldsymbol{\Phi_{N-1}(X)}\)</span> (matrice carrÃ© <span class="math notranslate nohighlight">\(N=p+1\)</span> aussi appellÃ©e la matrice de <em>Vandermonde</em>) correspond en fait exactement aux coefficients du polynÃ´me interpolateur de Lagrange qui en est lâ€™unique solution (si <span class="math notranslate nohighlight">\(x_j\neq x_i\forall j\neq i\)</span>)Â !</p>
</div>
<div class="admonition-exercice admonition">
<p class="admonition-title">Exercice</p>
<p><strong>Proposez un code qui rÃ©alise lâ€™interpolation de Lagrange par la mÃ©thode des EQN des moindres carrÃ©s et qui retourne pour chacune des valeurs de <span class="math notranslate nohighlight">\(x\)</span> son interpolation. (On pourra reprendre le code du TP sur la regresion linÃ©aire).</strong></p>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Polynomial</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deg</span> <span class="o">=</span> <span class="n">deg</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="c1"># here we transform the input into a polynomial</span>
        <span class="n">t</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">X</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">deg</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="c1">####### Complete this part ######## or die ####################</span>
        <span class="n">X_transformed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="o">...</span>
        <span class="c1">###############################################################</span>
        
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;You must fit the model first&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">X_transformed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X_transformed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">prediction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">(</span><span class="n">prediction</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">**</span><span class="mi">2</span>
        <span class="k">return</span> <span class="n">errors</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">errors</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">]):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">X</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Polynomial</span><span class="p">(</span><span class="n">n</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">S</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">S</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;EQN&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f_polynomial</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s2">&quot;--&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Lagrange&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Size:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition-exercice admonition">
<p class="admonition-title">Exercice</p>
<p>Dans votre rÃ©ponse pour lâ€™exercice prÃ©cÃ©dent, jouez avec <span class="math notranslate nohighlight">\(\texttt{pinv}\)</span> et <span class="math notranslate nohighlight">\(\texttt{inv}\)</span>. Comprenez-vous pourquoi la solution nâ€™est pas identique ?</p>
</div>
</div>
</div>
<div class="section" id="iv-splines">
<h2>IV. Splines<a class="headerlink" href="#iv-splines" title="Permalink to this headline">Â¶</a></h2>
<p>Comme nous lâ€™avons vu, il existe parfois certains effets pathologiques de lâ€™interpolation polynomiale oÃ¹ la fonction peut avoir des variations arbitrairement hautes entre les points de contrÃ´le. On aimerait dâ€™une certaine maniÃ¨re Ã©viter ces comportements de sorte Ã  ce que la fonction prenne des valeurs raisonnables entre les points. Nous allons voir ici une autre faÃ§on de construire une solution interpolatrice de notre jeu de donnÃ©e.</p>
<p>Lâ€™interpolation par <em>spline</em> consiste Ã  trouver des approximations locales de notre fonction. Plus formellement, il sâ€™agit de trouver pour chaque intervalle <span class="math notranslate nohighlight">\([x_i, x_{i+1}]\)</span> un polynÃ´me <span class="math notranslate nohighlight">\(P_i(x)\)</span> qui satisfait certaines propriÃ©tÃ©s. On aura ainsi une interpolation <span class="math notranslate nohighlight">\(S(x)\)</span> de la fonction qui nous intÃ©resse parÂ :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{aligned}S(x) =  
\begin{cases} 
P_1(x) &amp; x_1\leq x \leq x_2 \\
P_2(x) &amp; x_2\leq x \leq x_3 \\
\dots \\
P_{N-1}(x) &amp; x_{N-1}\leq x \leq x_N \\
\end{cases}\end{aligned}\end{split}\]</div>
<p>oÃ¹ chaque polynÃ´me intermÃ©diaire <span class="math notranslate nohighlight">\(P_i\)</span> dâ€™ordre <span class="math notranslate nohighlight">\(p\)</span> peut sâ€™Ã©crire de la maniÃ¨re suivanteÂ :</p>
<div class="math notranslate nohighlight">
\[P_i(x) = a_i^{(0)} + a_i^{(1)}(x - x_i) + \frac{a_i^{(2)}}{2}(x - x_i)^2 + \ldots + \frac{a_i^{(p)}}{p!}(x - x_i)^p\]</div>
<p>et oÃ¹ lâ€™on note <span class="math notranslate nohighlight">\((k)\)</span> comme un indice et non comme une puissance. Il sâ€™agira donc de determiner <span class="math notranslate nohighlight">\(p+1\)</span> coeficients pour chacun des <span class="math notranslate nohighlight">\(N-1\)</span> intervalles sÃ©parant les points de controles successifs.</p>
<div class="warning admonition">
<p class="admonition-title">Remarque</p>
<p>On remarque que les cas ou <span class="math notranslate nohighlight">\(p=0\)</span> et <span class="math notranslate nohighlight">\(p=1\)</span> correspondent respectivement Ã  lâ€™interpolateur constant par morceaux (ordre <span class="math notranslate nohighlight">\(0\)</span>) comme nous avons pu les voir dans les parties prÃ©cÃ©dentes. Les <em>splines</em> sont donc une gÃ©nÃ©ralisation des premiÃ¨res approches triviales vues dans la premiÃ¨re partie de ce TP. Lorsque <span class="math notranslate nohighlight">\(p=1\)</span>, certaines propriÃ©tÃ©s souhaitables ne sont plus garanties. On voudrait ainsi que la fonction soit au moins <span class="math notranslate nohighlight">\(\mathcal{C}^2\)</span> partout y compris au niveau des points de contrÃ´les oÃ¹ on constate pour lâ€™ordre 1 par exemple que la fonction nâ€™est pas lisse.</p>
</div>
<div class="section" id="a-les-splines-cubiques">
<h3>A. Les splines cubiques<a class="headerlink" href="#a-les-splines-cubiques" title="Permalink to this headline">Â¶</a></h3>
<p>Nous allons donc travailler avec un ordre <span class="math notranslate nohighlight">\(p=3\)</span> (les <em>splines</em> cubiques), et les polynÃ´mes <span class="math notranslate nohighlight">\(P_i\)</span> sont de la formeÂ :</p>
<div class="math notranslate nohighlight">
\[P_i(x) = a_i^{(0)} + a_i^{(1)}(x - x_i) + \frac{a_i^{(2)}}{2}(x - x_i)^2 + \frac{a_i^{(3)}}{6}(x - x_i)^3,\]</div>
<p>et tenter de construire une fonction interpolatrice <span class="math notranslate nohighlight">\(S\)</span> qui est <span class="math notranslate nohighlight">\(C^2\)</span>, câ€™est-Ã -dire continue avec les dÃ©rivÃ©es et dÃ©rivÃ©es doubles continues. Pour cela posons un certain nombre de contraintesÂ :</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(P_i(x_{i+1}) = P_{i+1}(x_{i+1}) = y_{i+1}\)</span> : la fonction doit Ãªtre continue au niveau des points de contrÃ´le,</p></li>
<li><p><span class="math notranslate nohighlight">\(P_i^{'}(x_{i+1}) = P_{i+1}^{'}(x_{i+1})\)</span> : la fonction dÃ©rivÃ©e doit Ãªtre continue au niveau des points de contrÃ´le,</p></li>
<li><p><span class="math notranslate nohighlight">\(P_i^{''}(x_{i+1}) = P_{i+1}^{''}(x_{i+1})\)</span> : et les dÃ©rivÃ©es secondes doivent Ãªtre continues au niveau des points de contrÃ´le.</p></li>
</ul>
<p>Pour <span class="math notranslate nohighlight">\(N\)</span> points, nous avons <span class="math notranslate nohighlight">\(N-1\)</span> intervalles et donc <span class="math notranslate nohighlight">\(N-1\)</span> polynÃ´mes Ã  trouver. Chaque polynÃ´me <span class="math notranslate nohighlight">\(P_i\)</span> possÃ¨de quatre coefficients <span class="math notranslate nohighlight">\(a_i^{(0)}, a_i^{(1)}, a_i^{(2)}\)</span> et <span class="math notranslate nohighlight">\(a_i^{(3)}\)</span> Ã  trouver. Cela nous donne <span class="math notranslate nohighlight">\(4(N-1)\)</span> coefficients Ã  trouver pour estimer S.</p>
<div class="admonition-question admonition">
<p class="admonition-title">Question</p>
<p><strong>Existe-t-il un ensemble unique de coeficients satisfaisant ces contraintes ? Si non, que rajouter comme contraintes afin de garantir lâ€™unicitÃ© de la solution ?</strong></p>
</div>
</div>
<div class="section" id="b-estimation-des-coefficients">
<h3>B. Estimation des coefficients<a class="headerlink" href="#b-estimation-des-coefficients" title="Permalink to this headline">Â¶</a></h3>
<div class="admonition-question-1 admonition">
<p class="admonition-title">Question 1</p>
<p><strong>Montrez Ã  partir de la contrainte 1 par identification quâ€™on peut trouver trÃ¨s facilement que <span class="math notranslate nohighlight">\(a_i^{(0)} = y_i\)</span></strong></p>
</div>
<p>Nous allons exprimer les <span class="math notranslate nohighlight">\(a_i^{(1)}, a_i^{(2)}\)</span> et <span class="math notranslate nohighlight">\(a_i^{(3)}\)</span> en fonction des dÃ©rivÃ©e et dÃ©rivÃ©e doubles de nos polynÃ´mes <span class="math notranslate nohighlight">\(P_i^\prime\)</span> et <span class="math notranslate nohighlight">\(P_i^{\prime\prime}\)</span>Â :</p>
<div class="math notranslate nohighlight">
\[P_i^{'}(x) = a_i^{(1)} + a_i^{(2)}(x - x_i) + \frac{a_i^{(3)}}{2}(x - x_i)^2\]</div>
<div class="math notranslate nohighlight">
\[P_i^{''}(x) = a_i^{(2)}+ a_i^{(3)}(x - x_i)\]</div>
<div class="admonition-question-2 admonition">
<p class="admonition-title">Question 2</p>
<p><strong>Montrez Ã  partir de la contrainte 4 quâ€™on obtient <span class="math notranslate nohighlight">\( a_i^{(3)} = \frac{a_{i+1}^{(2)} -  a_i^{(2)}}{\Delta x_i}\)</span> en notant <span class="math notranslate nohighlight">\(\Delta x_i = x_{i+1}-x_i, \forall i\)</span></strong></p>
</div>
<div class="admonition-question-3 admonition">
<p class="admonition-title">Question 3</p>
<p><strong>Montrez Ã  partir de <span class="math notranslate nohighlight">\(P_i(x_{i+1})=y_{i+1}\)</span> que <span class="math notranslate nohighlight">\(a_i^{(1)} = \frac{\Delta y_i}{\Delta x_i} - \frac{a_i^{(2)}}{3}\Delta x_i  -\frac{a_{i+1}^{(2)}}{6} \Delta x_i\)</span> en notant <span class="math notranslate nohighlight">\(\Delta y_i = y_{i+1} - y_i\)</span></strong></p>
</div>
<div class="admonition-question-4 admonition">
<p class="admonition-title">Question 4</p>
<p><strong>Finalement, montrez Ã  partir de la contrainte 3 et en injectant les expression de <span class="math notranslate nohighlight">\(a_i^{(1)}\)</span>, <span class="math notranslate nohighlight">\(a_{i+1}^{(1)}\)</span> et <span class="math notranslate nohighlight">\(a_i^{(3)}\)</span> Ã  partir de la formule prÃ©cÃ©dente que nous obtenons bienÂ :</strong></p>
<div class="math notranslate nohighlight">
\[\Delta x_i a_i^{(2)} + 2\big[ \Delta x_i + \Delta x_{i+1}\big]a_{i+1}^{(2)} + \Delta x_{i+1}a_{i+2}^{(2)} = 6 \big[F_{i+1} -  F_i\big],\]</div>
<p>oÃ¹ <span class="math notranslate nohighlight">\(F_i=\frac{\Delta y_i}{\Delta x_i}=\frac{y_{i+1}-y_i}{\Delta x_i}\)</span>.</p>
</div>
<p>On a donc un systÃ¨me de <span class="math notranslate nohighlight">\(N-2\)</span> Ã©quations et <span class="math notranslate nohighlight">\(N-2\)</span> inconnues (les <span class="math notranslate nohighlight">\(a_i^{(2)}\)</span> sans <span class="math notranslate nohighlight">\(a_1^{(2)}\)</span> et <span class="math notranslate nohighlight">\(a_{N}^{(2)}\)</span> quâ€™on Ã  fixÃ© Ã  0).</p>
<div class="warning admonition">
<p class="admonition-title">Remarque</p>
<p>On peut Ã©crire lâ€™Ã©quation prÃ©cÃ©dente sous une forme matricielleÂ :</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{pmatrix} 
2[\Delta x_1 + \Delta x_2] &amp; \Delta x_2 &amp; \dots &amp; 0\\
\Delta x_2 &amp; 2[\Delta x_2 + \Delta x_3] &amp; \Delta x_3 &amp; \dots\\
\vdots &amp;   \vdots  &amp;  \vdots  &amp; \vdots \\
0 &amp; 0 &amp; \dots &amp; 0\\
0 &amp; \dots &amp; \Delta x_{N-2}  &amp; 2[\Delta x_{N-2}+\Delta x_{N-1}]\\
\end{pmatrix} \begin{pmatrix} 
a_2^{(2)} \\
.\\
a_i^{(2)}\\
.\\
a_{N-1}^{(2)}
\end{pmatrix}  = \begin{pmatrix} 
\Delta F_1 \\
.\\
\Delta F_i\\
.\\
\Delta F_{N-1}
\end{pmatrix}\end{split}\]</div>
<p>en notant <span class="math notranslate nohighlight">\(\Delta F_i = 6 \big[F_{i+1} -  F_i\big]\)</span>. On remarque que cette matrice est creuse, lâ€™inversion dâ€™une telle matrice sera donc efficace numÃ©riquement:</p>
<div class="math notranslate nohighlight">
\[\Big[D\Big]\boldsymbol{a}^{(2)}  = \boldsymbol{\Delta F} \Leftrightarrow  \boldsymbol{a}^{(2)}  = \Big[D\Big]^{-1}\boldsymbol{\Delta F}\]</div>
</div>
<p>La suite consiste Ã  trouver les autres coefficients quâ€™on a dÃ©jÃ  exprimÃ©s en fonction de ceux que lâ€™on vient de trouver. Il ne nous reste plus quâ€™Ã  appliquer les relations dÃ©crites par les Ã©quationsÂ :</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(a_i^{(0)} = y_i\)</span> <span class="math notranslate nohighlight">\(\forall i\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(\boldsymbol{a}^{(2)}  = \Big[D\Big]^{-1}\boldsymbol{\Delta F}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(a_i^{(1)} = F_i - \frac{1}{3}\Big[a_i^{(2)}  + \frac{a_{i+1}^{(2)}}{2}\Big] \Delta x_i\)</span> <span class="math notranslate nohighlight">\(\forall i\)</span>,</p></li>
<li><p><span class="math notranslate nohighlight">\(a_i^{(3)} = \frac{a_{i+1}^{(2)} -  a_i^{(2)}}{\Delta x_i}\)</span> <span class="math notranslate nohighlight">\(\forall i\)</span>.</p></li>
</ul>
<p>Et le tour est jouÃ©, nous avons determinÃ© totalement les paramÃ¨tres de notre spline <span class="math notranslate nohighlight">\(S\)</span>.</p>
<div class="admonition-exercice admonition">
<p class="admonition-title">Exercice</p>
<p><strong>Proposez un code qui rÃ©alise le calcul dâ€™une spline cubique</strong></p>
</div>
<hr class="docutils" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">CubicSpline</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
        <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span> 
            <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            
            <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coefs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
            
            <span class="c1"># Fit Intermediate variables</span>
            <span class="c1">#  Complete Code  here ######## or die ##</span>
            <span class="n">dx</span> <span class="o">=</span> <span class="o">...</span>
            <span class="n">F</span>  <span class="o">=</span> <span class="o">...</span>
            <span class="n">dF</span> <span class="o">=</span> <span class="o">...</span>
            <span class="n">D</span>  <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">N</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
                <span class="o">...</span>
            <span class="c1">#########################################</span>
            
            <span class="c1"># Fit Spline coefficients</span>
            <span class="c1">#  Complete Code  here ######## or die ##</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coefs</span><span class="p">[:,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coefs</span><span class="p">[:,</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coefs</span><span class="p">[:,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">coefs</span><span class="p">[:,</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="o">...</span>
            <span class="c1">#########################################</span>
            
        <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
                <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">])</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
                <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">X</span> <span class="o">-</span> <span class="n">v</span>
                <span class="n">left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
                <span class="n">left</span><span class="p">[</span><span class="n">left</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
                <span class="n">left</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
                <span class="n">right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">dist</span><span class="p">)</span>
                <span class="n">right</span><span class="p">[</span><span class="n">right</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="s1">&#39;inf&#39;</span><span class="p">)</span>
                <span class="n">right</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>

                <span class="n">i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">left</span><span class="p">)</span>
                <span class="n">i_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">right</span><span class="p">)</span>

                <span class="k">if</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">left</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span>
                    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
                <span class="k">elif</span> <span class="ow">not</span> <span class="n">np</span><span class="o">.</span><span class="n">isfinite</span><span class="p">(</span><span class="n">right</span><span class="p">[</span><span class="n">i_</span><span class="p">]):</span>
                    <span class="n">i</span> <span class="o">=</span>  <span class="bp">self</span><span class="o">.</span><span class="n">N</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="c1">#  Complete Code  here ######## or die ##</span>
                <span class="o">...</span>
                <span class="c1">#########################################</span>
            <span class="k">return</span> <span class="n">y</span>
        
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">]):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">X</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">S</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">spline</span> <span class="o">=</span> <span class="n">CubicSpline</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">S</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">spline</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Size:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>Nous pouvons aussi utiliser lâ€™outil <span class="math notranslate nohighlight">\(\texttt{CubicSpline}\)</span> de <span class="math notranslate nohighlight">\(\texttt{scipy}\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.interpolate</span> <span class="kn">import</span> <span class="n">CubicSpline</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">([</span><span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">50</span><span class="p">]):</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
    <span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">X</span><span class="p">)],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">S</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])</span>
    <span class="n">spline</span> <span class="o">=</span> <span class="n">CubicSpline</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[</span><span class="n">idx</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">S</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">spline</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Size:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/3_interpolation_46_0.png" src="../_images/3_interpolation_46_0.png" />
</div>
</div>
</div>
</div>
<div class="section" id="v-de-l-interpollation-vers-l-approximation">
<h2>V. De lâ€™interpollation vers lâ€™approximation<a class="headerlink" href="#v-de-l-interpollation-vers-l-approximation" title="Permalink to this headline">Â¶</a></h2>
<p>Nous allons voir ici une autre maniÃ¨re de contrÃ´ler un peu les fluctuations entre les points de contrÃ´le qui va consister Ã  trouver une fonction qui ne passe plus nÃ©cessairement exactement sur chaque point mais qui reste tout de mÃªme proche de la solution dâ€™interpolation. Plus formellement, au lieu dâ€™avoir <span class="math notranslate nohighlight">\(\forall x_i \in \mathcal{S}, \tilde{f}(x_i) = f^{\star}(x_i)\)</span>, nous aurons plutÃ´t <span class="math notranslate nohighlight">\(\forall x_i \in \mathcal{S}, \tilde{f}(x_i) \approx f^{\star}(x_i)\)</span>. On parlera plutÃ´t dâ€™approximation de la fonction.</p>
<p>Comme nous lâ€™avons vu, il est possible dâ€™avoir des comportements non souhaitables via la solution des EQN quand la matrice <span class="math notranslate nohighlight">\(X^TX\)</span> est mal conditionnÃ©e. Ce comportement apparaÃ®t notamment, si ses valeurs propres sont trÃ¨s petites voir nulles, on parle de matrice presque singuliÃ¨re dont lâ€™inverse possÃ¨de alors une norme forte. Le problÃ¨me est alors <em>mal posÃ©</em> car la solution devient trÃ¨s sensible aux fluctuations du bruit dans les donnÃ©es.</p>
<div class="margin sidebar">
<p class="sidebar-title"></p>
<p><strong>ProblÃ¨me bien posÃ©Â :</strong>
On parle dâ€™un problÃ¨me <span class="math notranslate nohighlight">\(\mathcal{P}\)</span> <em>bien posÃ©</em> lorsque la formalisation de ce dernier sous la forme dâ€™un problÃ¨me dâ€™optimisation conduit Ã  une solution qui possÃ¨de les propriÃ©tÃ©s suivantesÂ :</p>
<ol class="simple">
<li><p>Elle existe.</p></li>
<li><p>Elle est unique.</p></li>
<li><p>Elle est stable (<em>i.e.</em> elle dÃ©pend continuement des donnÃ©es, <span class="math notranslate nohighlight">\(\lVert\hat{\beta} - \hat{\beta}_0\rVert &lt; K \lVert X - X_0 \rVert\)</span> avec <span class="math notranslate nohighlight">\(K\)</span> pas trop grand, <em>i.e.</em> la variation de la solution est bornÃ©e par une certaine quantitÃ© proportionelle Ã  la variation dans les donnÃ©es).</p></li>
</ol>
<p>Par dÃ©finition on dira quâ€™un problÃ¨me est mal posÃ© si lâ€™une des conditions prÃ©cÃ©dentes nâ€™est pas respectÃ©e.</p>
</div>
<p>Nous allons donc ici considÃ©rer une formulation dite rÃ©gularisÃ©e de notre problÃ¨me de rÃ©gression polynomiale afin de mieux contrÃ´ler les fluctuations de ce dernier. Plus formellement, cela correspond Ã  transformer notre problÃ¨me <em>mal posÃ©</em> <span class="math notranslate nohighlight">\(\mathcal{P}\)</span> en une suite de problÃ¨mes <em>bien posÃ©s</em> <span class="math notranslate nohighlight">\(\mathcal{P}_\lambda, \lambda \in \mathbb{R}^{+}\)</span>, tel que <span class="math notranslate nohighlight">\( \lim\limits_{\lambda \rightarrow 0}\hat{\beta}_{\lambda} = \hat{\beta}\)</span>. Avec <span class="math notranslate nohighlight">\(\hat{\beta}\)</span> et <span class="math notranslate nohighlight">\(\hat{\beta}_{\lambda}\)</span> les solutions respectives des problÃ¨mes <span class="math notranslate nohighlight">\(\mathcal{P}\)</span> et <span class="math notranslate nohighlight">\(\mathcal{P}_\lambda\)</span>. La formulation rÃ©gularisÃ©e dâ€™un problÃ¨me dâ€™optimisation sâ€™Ã©crit de la faÃ§on suivanteÂ :</p>
<div class="math notranslate nohighlight">
\[J^{\mathcal{D}}_{\lambda}(\beta) =  J_{\mathcal{D}}(\beta) + \lambda  \mathcal{\Omega}(\beta)\]</div>
<p>oÃ¹Â :</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(J_{\mathcal{D}}(\beta)\)</span> correspond Ã  lâ€™expression de la fonction objectif du problÃ¨me original,</p></li>
<li><p><span class="math notranslate nohighlight">\( \mathcal{\Omega}(\beta)\)</span> correspond au terme de rÃ©gularisation sur le vecteur des paramÃ¨tres. Ce dernier terme correspond Ã  une contrainte que lâ€™on souhaiterait optimiser conjointement sur le vecteur des paramÃ¨tres avec plus ou moins dâ€™importance par rapport Ã  la fonction objectif dâ€™origine,</p></li>
<li><p>On rÃ©glera <span class="math notranslate nohighlight">\(\lambda\)</span> en fonction de lâ€™importance relative de la contrainte sur le vecteur des paramÃ¨tres (et nous verrons pus tard que cela est Ã©quivalent Ã  un problÃ¨me dâ€™optimisation sous contrainte ou \lambda joue le rÃ´le du multiplicateur de Lagrange).</p></li>
</ol>
<p>Pour limiter lâ€™amplitude des fluctuations du polynÃ´me entre les points nous pouvons donc construire une version rÃ©gularisÃ©e de la fonction objectif des moindres carrÃ©s suivante pour trouver une solution dont les coeficients sont les plus petits possiblesÂ :</p>
<div class="math notranslate nohighlight">
\[J_{\lambda}^{\mathcal{D}}(\beta) = ||\boldsymbol{y} - \boldsymbol{X}\boldsymbol{\beta}||_2^2 + \lambda||\boldsymbol{\beta}||_2^2\]</div>
<div class="warning admonition">
<p class="admonition-title">Remarque</p>
<p>Quand <span class="math notranslate nohighlight">\(\lambda \rightarrow 0\)</span>, <span class="math notranslate nohighlight">\(J_{\lambda}(\beta)^{\mathcal{D}} \rightarrow J(\beta)\)</span>. Quand <span class="math notranslate nohighlight">\(\lambda \rightarrow +\infty\)</span>, <span class="math notranslate nohighlight">\(J_{\lambda}(\beta)^{\mathcal{D}} \approx \lambda ||\boldsymbol{\beta}||_2^2 = \sum_{d=0}^p\beta_d^2\)</span> et la solution optimal <span class="math notranslate nohighlight">\(\hat{\boldsymbol{\beta}}_{\lambda} \rightarrow \boldsymbol{0}\)</span>, <em>i.e.</em> la pÃ©nalitÃ© â€œdomineâ€ et la solution est indÃ©pendante des donnÃ©es.</p>
</div>
<hr class="docutils" />
<p>Chercher Ã  trouver le minimum de la fonction revient Ã  trouver les <span class="math notranslate nohighlight">\(\beta\)</span> tels que le gradient sâ€™annule.</p>
<div class="admonition-question admonition">
<p class="admonition-title">Question</p>
<p><strong>Calculer la nouvelle valeur de <span class="math notranslate nohighlight">\(\boldsymbol{\beta}\)</span> qui annule le gradient de cette nouvelle fonction objectif.</strong></p>
</div>
<div class="admonition-question admonition">
<p class="admonition-title">Question</p>
<p><strong>Peut on trouver une solution interpolatrice avec cette version rÃ©gularisÃ©e des moindres carrÃ©s ?</strong></p>
</div>
<hr class="docutils" />
<div class="admonition-exercice admonition">
<p class="admonition-title">Exercice</p>
<p><strong>Proposez une implÃ©mentation dâ€™approximation du polynome interpolateur basÃ© sur cette version rÃ©gularisÃ©e des moindres carrÃ©s. On pourra reprendre le code dÃ©jÃ  effectuÃ© dans le TP regression linÃ©aire.</strong></p>
</div>
<hr class="docutils" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Polynomial_reg</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">deg</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">deg</span> <span class="o">=</span> <span class="n">deg</span>

    <span class="k">def</span> <span class="nf">_transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="c1"># here we transform the input into a polynomial</span>
        <span class="n">t</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">X</span> <span class="o">=</span> <span class="n">X</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">))</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">X</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="k">else</span> <span class="n">X</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">deg</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">t</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">X</span><span class="o">**</span><span class="n">i</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="c1">####### Complete this part ######## or die ####################</span>
        <span class="n">X_transformed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="o">...</span>
        <span class="c1">###############################################################</span>
        
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;You must fit the model first&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">X_transformed</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">X_transformed</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">beta</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">score</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="n">prediction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
        <span class="n">errors</span> <span class="o">=</span> <span class="p">(</span><span class="n">prediction</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">**</span><span class="mi">2</span>
        <span class="k">return</span> <span class="n">errors</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">/</span><span class="n">errors</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">X</span><span class="p">)</span><span class="o">+</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.005</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,))</span>
<span class="n">S</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="n">d</span> <span class="o">=</span> <span class="n">n</span><span class="o">-</span><span class="mi">1</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">S</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">S</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">k</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="c1">#[2:2+3]</span>
<span class="n">alphas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mf">0.0</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>

<span class="k">for</span> <span class="n">c</span><span class="p">,</span> <span class="n">alpha</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">colors</span><span class="p">,</span> <span class="n">alphas</span><span class="p">):</span><span class="c1">#[0, 1e-06, 1e-01]):</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Polynomial_reg</span><span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">alpha</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;regularity:&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">alpha</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<div class="warning admonition">
<p class="admonition-title">Remarques</p>
<ul class="simple">
<li><p>La solution <span class="math notranslate nohighlight">\(\hat{\boldsymbol{\beta}}_{\lambda}\)</span> augmente en â€œcomplÃ©xitÃ©â€ quand <span class="math notranslate nohighlight">\(\lambda \rightarrow 0\)</span> et converge vers la solution interpolatrice <span class="math notranslate nohighlight">\(\hat{\boldsymbol{\beta}}\)</span>.</p></li>
<li><p>En rÃ©gularisant, on paye le prix de sâ€™Ã©loigner des valeurs <span class="math notranslate nohighlight">\({(x_i, y_i})\)</span> au profit dâ€™Ãªtre plus â€œraisonableâ€ entre elles. Il est dâ€™autant plus raisonable de ne pas passer exactement sur les donnÃ©es que les fluctuations de <span class="math notranslate nohighlight">\(y\)</span> dues au bruit sont importantes.</p></li>
<li><p><span class="math notranslate nohighlight">\(\mathcal{P}_{\lambda}^{\mathcal{D}}\)</span> pour <span class="math notranslate nohighlight">\(( \lambda, \mathcal{D})\)</span> donnÃ©s est unique (mÃªme si le problÃ¨me non rÃ©gularisÃ© ne lâ€™est pas), on peut dÃ©finir un <em>chemin de rÃ©gularisation</em> unique en faisant varier <span class="math notranslate nohighlight">\(\lambda\)</span>, câ€™est Ã  dire une unique sÃ©quence de solutions rÃ©gularisÃ©es <span class="math notranslate nohighlight">\(\hat{\boldsymbol{\beta}}_{\lambda}\)</span> convergeant vers la solution interpolatrice Ã  mesure que <span class="math notranslate nohighlight">\(\lambda \rightarrow 0\)</span>.</p></li>
<li><p>Ainsi, on peut voir lâ€™approximation dâ€™une fonction comme un <em>arrÃªt prÃ©maturÃ©</em> (<em>early stopping</em> en anglais) le long de ce chemin de rÃ©gularisation.</p></li>
</ul>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./2_regression"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="2_optimization.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Lâ€™optimisation â˜•ï¸â˜•ï¸</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="4_algo_proximal_lasso.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Sous-diffÃ©rentiel et le cas du Lasso â˜•ï¸â˜•ï¸â˜•ï¸</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Servajean, Leveau & Chailan<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>